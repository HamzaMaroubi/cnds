@{
    ViewBag.Title = "Search Data Sources";
    Layout = "~/Views/_Layout.cshtml";
}

@section Scripts{
<script src="@(System.Web.Configuration.WebConfigurationManager.AppSettings["ServiceUrl"])scripts/lpp.cnds.interfaces.js"></script>
<script src="~/areas/cnds/js/search/common.js"></script>
@*<script src="~/areas/cnds/js/search/datasources-qlik.js"></script>*@

<script type="text/javascript">
    $(document).ready(function () {
        var cssURL = "@(string.Format("{0}resources/autogenerated/qlik-styles.css{1}",ViewBag.QlikBaseUrl, (string.IsNullOrEmpty(ViewBag.QlikTicket) ? string.Empty : "?" + ViewBag.QlikTicket)))";
        var jsURL = "@(string.Format("{0}resources/assets/external/requirejs/require.js{1}", ViewBag.QlikBaseUrl, (string.IsNullOrEmpty(ViewBag.QlikTicket) ? string.Empty : "?" + ViewBag.QlikTicket)))";
        $.ajax({
            type: "GET",
            url: jsURL,
            dataType: "script",
            crossDomain: true,
            success: function (param) {
                $('head').append('<link rel="stylesheet" type="text/css" href="' + cssURL + '">');
                $.ajax({
                    cache: true,
                    dataType: "script",
                    url: "/areas/cnds/js/search/datasources.js",
                });
            }
        });
    });
</script>
}

@section Head{

@*<script src="@(string.Format("{0}resources/assets/external/requirejs/require.js{1}", ViewBag.QlikBaseUrl, (string.IsNullOrEmpty(ViewBag.QlikTicket) ? string.Empty : "?" + ViewBag.QlikTicket)))"></script>
<link rel="stylesheet" href="@(string.Format("{0}resources/autogenerated/qlik-styles.css{1}",ViewBag.QlikBaseUrl, (string.IsNullOrEmpty(ViewBag.QlikTicket) ? string.Empty : "?" + ViewBag.QlikTicket)))" />*@
<style>
    div.qvobject, div.qvplaceholder {
        /*padding: 30px 10px 10px 10px;*/
        padding:0px;
        margin:0px;
        height: 800px;
        
    }

    .qcmd {
        cursor: pointer;
    }
    /*.qlik-wrapper {
        border:1px solid green;
        padding:0px;
    }*/
    .qv-object-content-container{
        border:1px solid #CCC;
    }
    #QV01 {
        /*width:1000px;*/
        /*margin-left:auto;
        margin-right:auto;*/
    }
</style>
}

<article class="panel panel-default" data-bind="css: {visible: true}">

    <div class="panel-heading">
        <ol class="breadcrumb">
            <li><a href="/">Home</a></li>
            <li>CNDS</li>
            <li class="active">Search Data Sources</li>
        </ol>
    </div>

    <div class="panel-body">
        <div class="qlik-wrapper">
            <div class="qvobject" id="QV01"></div>
        </div>
    </div>
    <nav class="panel-footer right">
        <button class="btn btn-default pull-right" data-bind="click:onSelectRequestType, enable:NumberOfSelectedDataSources() > 0 && DisableNewRequestButton() == false"><i class="glyphicon glyphicon-plus" aria-hidden="true"></i> New Request</button>
        <div class="clearfix"></div>
    </nav>
    
</article>


<article class="panel panel-success" data-bind="visible:$root.SelectedRequestTypeDetails() != null, css:{visible: true}">
    <div class="panel-heading"><strong>Selected RequestType Details</strong></div>    
    <div class="panel-body" style="padding:0px;">
        <div style="padding:15px 15px 5px 15px;">
            <strong>RequestType:</strong> <span data-bind="text:$root.SelectedRequestTypeName()"></span><br />
            <strong>Project:</strong> <span data-bind="text:$root.SelectedRequestTypeProjectName()"></span><br/>
        </div>
        <p style="margin-bottom:0px;padding-bottom:0px;padding-left:15px;border-bottom:1px solid #e5e5e5;"><strong>Selected Routes</strong></p>        
        <table class="table table-striped" style="margin-top:0px;">
            <thead>
                <tr>
                    <th>Network</th>
                    <th>Project</th>
                    <th>RequestType</th>
                    <th>DataSource</th>
                </tr>
            </thead>
            <tbody data-bind="foreach:{data: $root.SelectedRequestTypeRoutes(), as: 'route'}">
                <tr>
                    <td data-bind="text:route.Network"></td>
                    <td data-bind="text:route.Project"></td>
                    <td data-bind="text:route.RequestType"></td>
                    <td data-bind="text:route.DataMart"></td>
                </tr>
            </tbody>
        </table>
    </div>
</article>


